function convertSpeed(e){var t=-1,n=["KB","MB","GB","TB","PB","EB","ZB","YB"];do{e/=1024,t++}while(e>1024);return Math.max(e,.1).toFixed(1)+" "+n[t]}function formatFileSize(e,t){var n=["Bytes","KB","MB","GB","TB"];if(0==e)return"n/a";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return 0==a?e+" "+n[a]:(e/Math.pow(1024,a)).toFixed(1)+" "+n[a]}if(parsingurl=new URLSearchParams(window.location.search),page=parsingurl.get("page"),act=parsingurl.get("act"),dir=null==parsingurl.get("dir")?default_dir:parsingurl.get("dir"),type=parsingurl.get("type"),file=parsingurl.get("file"),directory=String.raw`${atob(directory)}`,$(".btn-backup").on("click",function(e){e.preventDefault();var t=$(this);if(files=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&files.push($(this).data("hash"))}),0===files.length)return toastr.error("Belum ada file yang dipilih!","Warning"),!1;t.html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("button").attr("disabled",!0),$.ajax({url:baseurl,type:"post",data:{backup:"",files:files},success:function(e){let n=JSON.parse(e);!0===n.status?window.location.reload():(toastr.error(n.pesan,"Warning"),t.html('<i class="fa fa-archive"></i>'),$("button").removeAttr("disabled",!0))},error:function(){toastr.error("Something wrong!","Warning"),t.html('<i class="fa fa-archive"></i>'),$("button").removeAttr("disabled",!0)}})}),$(".click-menu").on("click",function(e){e.preventDefault();var t=$(this);$(".menus"+t.data("hash")).html('<div class="text-center"><small><i class="fa fa-circle-o-notch fa-spin"></i> Processing</small></div>'),$.post(`${baseurl}?page=list_breadcrumb`,{path:t.data("path")},function(e){$(".menus"+t.data("hash")).html(atob(e))})}),$("#showpass").on("click",function(e){!0===$(this).is(":checked")?$(".pass").attr("type","text"):$(".pass").attr("type","password")}),"setting"===page&&$("#form-setting").on("submit",function(e){e.preventDefault();var t=$(this);$.ajax({url:`${baseurl}?page=simpan`,type:"post",data:t.serializeArray(),success:function(e){window.location.reload()}})}),loadListDirectory=(()=>{$(".list_directory").html('<div class="mt-3"><div class="box"></div><div class="box"></div><div class="box"></div></div>'),$.get(`${baseurl}?page=list`,{folder:folder},function(e){$(".list_directory").html(atob(e)),window.scrollTo(0,parseInt(sessionStorage.getItem("scroll")))})}),""!==isLogin&&"edit"!==page&&"confirmation"!==page&&"add"!==page&&"setting"!==page?(window.addEventListener("scroll",e=>{let t=this.scrollY;sessionStorage.setItem("scroll",t),parseInt(t)>120?$(".floating").addClass("isfloating"):$(".floating").removeClass("isfloating")}),loadListDirectory()):window.scrollTo(0,0),"edit"===page){$(".loading").show(),$.post(`${baseurl}`,{read_file:"",file:file},function(e){$(".loading").hide(),$("#codearea").fadeIn("slow").show(),document.querySelector("#codearea").value=window.atob(window.atob(window.atob(e))),codemirrorEditor=CodeMirror.fromTextArea(document.getElementById("codearea"),{lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0,keyMap:"sublime",theme:"material-ocean",matchBrackets:!0,mode:{name:"javascript",startOpen:!0},extraKeys:{"Alt-F":"findPersistent",F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}},indentUnit:4,indentWithTabs:!0,lineWrapping:!0,tabSize:4}),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(e){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)});var ask=!1;fungsi_simpan=(()=>{var e=$(".btn-simpan-file"),t=codemirrorEditor.getValue(),n=$(".path_file").val(),a=$(".path").val(),r=$("#nama_file").val(),o=$(".password").val(),i=new XMLHttpRequest;if(""===o.trim())return toastr.error("Password can't empty!","Warning"),!1;e.html('<i class="fa fa-circle-o-notch fa-spin"></i>').attr("disabled",!0),i.onload=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.response);1==t.status?(ask=!1,toastr.success(t.response,"Information")):toastr.error(t.response,"Warning"),e.html('<i class="fa fa-save"></i>').removeAttr("disabled")}else alert("Target server reached, but it returned an error")},i.onerror=function(){},i.open("POST",baseurl,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send("savefile=&folder="+a+"&nama_file="+r+"&path="+n+"&password="+o+"&content="+encodeURIComponent(t))}),$(window).bind("keydown",function(e){if(e.ctrlKey||e.metaKey)switch(String.fromCharCode(e.which).toLowerCase()){case"s":e.preventDefault(),fungsi_simpan()}"textarea"===e.target.localName&&(ask=!0)}),$(".btn-simpan-file").on("click",function(e){e.preventDefault(),fungsi_simpan()}),$(".btn-fullscreen").on("click",function(e){e.preventDefault(),$(".card.editor").addClass("fullscreen");var t=window.innerHeight;$(".CodeMirror").css({height:`${t-85}px`}),window.addEventListener("resize",function(e){t=window.innerHeight,$(".CodeMirror").css({height:`${t-85}px`})},!0),$(".btn-fullscreen").hide(),$(".btn-minimize").show()}),$(".btn-minimize").on("click",function(e){e.preventDefault(),$(".card.editor").removeClass("fullscreen"),$(".btn-fullscreen").show(),$(".btn-minimize").hide(),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(e){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)}),window.onbeforeunload=function(e){if(!0===ask)return e=e||window.event,e&&(e.returnValue="Sure?"),"Sure?"}}if("add"===page&&"file"===type){var codemirrorEditor;codemirrorEditor=CodeMirror.fromTextArea(document.getElementById("codearea"),{lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0,keyMap:"sublime",theme:"material-ocean",matchBrackets:!0,mode:{name:"javascript",startOpen:!0},indentUnit:4,indentWithTabs:!0,lineWrapping:!0,tabSize:4,extraKeys:{"Alt-F":"findPersistent",F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}}}),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(e){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0);ask=!1;$(window).bind("keydown",function(e){ask=!0}),$(".btn-simpan-file").on("click",function(e){e.preventDefault();var t=new FormData(document.getElementById("form-add-file")),n=codemirrorEditor.getValue();t.append("content",n),t.append("nama_file",document.getElementById("nama_file").value.trim()),$(".btn-simpan-file").html('<i class="fa fa-circle-o-notch fa-spin"></i>').attr("disabled",!0),$.ajax({url:`${baseurl}`,type:"post",data:t,processData:!1,contentType:!1,dataType:"json",success:function(e){!0===e.status?(ask=!1,toastr.success(e.pesan,"Success"),setTimeout(()=>{window.location.href=e.redirect},1e3)):($(".btn-simpan-file").html('<i class="fa fa-save"></i>'),toastr.error(e.pesan,"Warning"))}})}),$(".btn-fullscreen").on("click",function(e){e.preventDefault(),$(".card.editor").addClass("fullscreen");var t=window.innerHeight;$(".CodeMirror").css({height:`${t-85}px`}),window.addEventListener("resize",function(e){t=window.innerHeight,$(".CodeMirror").css({height:`${t-85}px`})},!0),$(".btn-fullscreen").hide(),$(".btn-minimize").show()}),$(".btn-minimize").on("click",function(e){e.preventDefault(),$(".card.editor").removeClass("fullscreen"),$(".btn-fullscreen").show(),$(".btn-minimize").hide(),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(e){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)}),window.onbeforeunload=function(e){if(!0===ask)return e=e||window.event,e&&(e.returnValue="Sure?"),"Sure?"}}var Modal;$("#login").on("submit",function(e){e.preventDefault();var t=$(this),n=$(this).find("button").text(),a=$(this).find("button");a.html(`<i class="fa fa-circle-o-notch fa-spin"></i> ${n}`).attr("disabled",!0),$.ajax({url:`${baseurl}`,type:"post",data:t.serializeArray(),dataType:"json",success:function(e){!0===e.status?(toastr.success(e.pesan,"Success"),setTimeout(()=>{window.location.reload()},1e3)):(toastr.error(e.pesan,"Warning"),a.html(`${n}`).removeAttr("disabled"))}})}),btnActionSimpan=(()=>{$("button.btn-simpan").on("click",function(e){e.preventDefault();var t=$("form"),n=$(this).text(),a=$(this);$(".modal-footer").find("button").attr("disabled",!0),a.html(`<i class="fa fa-circle-o-notch fa-spin"></i> ${n}`),$.ajax({url:`${baseurl}`,type:"post",data:t.serializeArray(),dataType:"json",success:function(e){!0===e.status?(toastr.success(e.pesan,"Success"),setTimeout(()=>{Modal.close(),loadListDirectory()},1e3)):(toastr.error(e.pesan,"Warning"),a.html(n),$(".modal-footer").find("button").removeAttr("disabled",!0))},error:function(){toastr.error("Something wrong!","Warning"),a.html(n),$(".modal-footer").find("button").removeAttr("disabled",!0)}})})}),btnTambahFolder=(e=>{hash=e.getAttribute("data-hash"),dir=e.getAttribute("data-dir"),Modal.create("Tambah Folder","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="add_folder">\n            <input type="hidden" name="dir" value="${hash}">\n            <div class="alert alert-warning">Target : <strong>${dir}</strong></div>\n            <div class="form-group">\n                <label>Folder</label>\n                <input type="text" class="form-control" name="nama_folder"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnUbahFolder=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),Modal.create("Ubah Folder","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="edit_folder">\n            <input type="hidden" name="folder" value="${dir}">\n            <div class="form-group">\n                <label>Folder</label>\n                <input type="text" class="form-control" name="nama_folder" value="${name}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnHapusFolder=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),Modal.create("Hapus Folder","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="delete_folder">\n            <input type="hidden" name="folder" value="${dir}">\n            <div class="alert alert-warning">Anda yakin ingin menghapus folder <strong>${name}</strong> secara permanen?</div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnSalinFolder=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),Modal.create("Salin Folder","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="salin_folder">\n            <input type="hidden" name="folder" value="${dir}">\n            <div class="alert alert-warning">Folder : <strong>${name}</strong></div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnPindahFolder=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),Modal.create("Pindah Folder","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="pindah_folder">\n            <input type="hidden" name="folder" value="${dir}">\n            <div class="alert alert-warning">Folder : <strong>${name}</strong></div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnUbahFile=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.create("Ubah File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="edit">\n            <input type="hidden" name="path_file" value="${file}">\n            <input type="hidden" name="folder" value="${dir}">\n            <div class="form-group">\n                <label>File</label>\n                <input type="text" class="form-control" name="nama_file" value="${name}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnHapusFile=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.create("Hapus File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="delete">\n            <input type="hidden" name="path_file" value="${file}">\n            <div class="alert alert-warning">Anda yakin ingin menghapus file <strong>${name}</strong> secara permanen?</div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnSalinFile=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.create("Salin File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="copy">\n            <input type="hidden" name="path_file" value="${file}">\n            <div class="alert alert-warning">File : <strong>${name}</strong></div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnPindahFile=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.create("Pindah File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="move">\n            <input type="hidden" name="path_file" value="${file}">\n            <div class="alert alert-warning">File : <strong>${name}</strong></div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnEkstrakFile=(e=>{name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.create("Ekstrak File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="ekstrak">\n            <input type="hidden" name="files" value="${file}">\n            <div class="alert alert-warning">File : <strong>${name}</strong></div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),btnDownloadFile=(e=>{var t,n;name=e.getAttribute("data-name"),dir=e.getAttribute("data-dir"),file=e.getAttribute("data-file"),Modal.createNoFooter("Download File"),Modal.html(`\n        <form>\n            <input type="hidden" name="download">\n            <input type="hidden" id="file" value="${file}">\n            <div class="alert alert-warning">File : <strong>${name}</strong></div>\n            <div class="form-group showpassword">\n                <label>Password</label>\n                <input type="password" class="form-control password"/>\n            </div>\n            <label for="cekzip">\n            <input id="cekzip" type="checkbox" value="0">\n                Archive (Zip)\n            </label>\n            <div class="show-download" style="display: none;">\n                <a href="" class="btn btn-primary btn-block">Download Manual <small>(Opsi jika file terlalu besar)</small></a>\n                <div class="text-center mt-2"><label>atau</label></div>\n            </div>\n            <button type="submit" id="download-button" class="btn btn-primary btn-block">Generate Download</button>\n            <a id="save-file" class="btn btn-primary mt-2" style="display: none;">Save File</a>\n            <button id="btn-back" style="display: none;" class="btn btn-danger btn-block mt-2">Kembali</button>\n            <div class="showprogress" style="display: none;">\n                <div class="progress mt-2">\n                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                </div>\n                <div class="progress-text text-center"></div>\n            </div>\n        </form>\n    `);var a=!1;document.querySelector("#cekzip").addEventListener("click",function(e){var t=this;0==t.value?t.value=1:t.value=0}),document.querySelector("#download-button").addEventListener("click",function(e){e.preventDefault();var r=$(".password").val(),o=document.getElementById("cekzip").value,i=document.getElementById("file").value;document.querySelector("#download-button").setAttribute("disabled","disabled"),$.post(`${baseurl}`,{download:"",password:r,iszip:o,file:i},function(e){let o=JSON.parse(e);if(!0===o.status){var i=new XMLHttpRequest,l=(new Date).getTime();n=o.filename,namefile=o.name,$(".show-download").fadeIn("slow").show(),$(".show-download a").attr("href",n),i.addEventListener("readystatechange",function(e){if(2==i.readyState&&200==i.status)document.querySelector("#download-button").style.display="none",document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector(".showprogress").style.display="block",document.querySelector("#download-button").setAttribute("disabled","disabled");else if(3==i.readyState);else if(4==i.readyState)try{t=URL.createObjectURL(i.response),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").setAttribute("href",t),document.querySelector("#save-file").setAttribute("download",namefile),document.querySelector("#save-file").style.display="block",document.querySelector(".progress").style.display="none",$.post(`${baseurl}`,{deletefile:"",filename:n,password:r},function(e){}),a=!1,document.querySelector("#btn-back").style.display="block",document.querySelector("#btn-back").addEventListener("click",function(e){e.preventDefault(),document.querySelector(".show-download").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="block",document.querySelector(".password").value=""})}catch(e){toastr.error(e,"Warning"),document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",window.URL.revokeObjectURL(t)}}),i.addEventListener("progress",function(e){var t=e.loaded/e.total*100,n=((new Date).getTime()-l)/1e3,r=e.loaded/n,o=r/1024;o=Math.floor(o);var i=(e.total-e.loaded)/r,s=i%60,d=i/60;s=Math.floor(s),d=Math.floor(d),a=!0,document.querySelector(".progress-bar").style.width=t+"%",document.querySelector(".progress-bar").innerHTML=parseFloat(t).toFixed(2)+"%",document.querySelector(".progress-text").innerHTML=convertSpeed(r)+" / s<br>"+(d>0?d+" min ":"")+s+" sec remaining"}),i.responseType="blob",i.open("get",n),i.send()}else toastr.error(o.response,"Warning"),document.querySelector("#download-button").removeAttribute("disabled")})}),window.onbeforeunload=function(e){if(!0===a)return e=e||window.event,e&&(e.returnValue="Sure?"),"Sure?"}}),btnDownloadBackup=(e=>{var t,n;name=e.getAttribute("data-name"),size=e.getAttribute("data-size"),time=e.getAttribute("data-time"),Modal.createNoFooter("Download File Backup"),Modal.html(`\n        <form>\n            <input type="hidden" name="downloadbackup">\n            <div class="alert alert-warning">\n                File : <strong>${name}</strong><br>\n                Size : <strong>${size}</strong><br>\n                Created : <strong>${time}</strong>\n            </div>\n            <div class="form-group showpassword">\n                <label>Password</label>\n                <input type="password" class="form-control password"/>\n            </div>\n            <div class="show-download" style="display: none;">\n                <a href="" class="btn btn-primary btn-block">Download Manual <small>(Opsi jika file terlalu besar)</small></a>\n                <div class="text-center mt-2"><label>atau</label></div>\n            </div>\n            <button type="submit" id="download-button" class="btn btn-primary btn-block">Generate Download</button>\n            <a id="save-file" class="btn btn-primary mt-2" style="display: none;">Save File</a>\n            <button id="btn-back" style="display: none;" class="btn btn-danger btn-block mt-2">Kembali</button>\n            <div class="showprogress" style="display: none;">\n                <div class="progress mt-2">\n                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                </div>\n                <div class="progress-text text-center"></div>\n            </div>\n        </form>\n    `);var a=!1;document.querySelector("#download-button").addEventListener("click",function(e){e.preventDefault();var r=$(".password").val();document.querySelector("#download-button").setAttribute("disabled","disabled"),$.post(`${baseurl}`,{downloadbackup:"",password:r},function(e){let o=JSON.parse(e);if(!0===o.status){var i=new XMLHttpRequest,l=(new Date).getTime();n=o.filename,namefile=o.name,$(".show-download").fadeIn("slow").show(),$(".show-download a").attr("href",n),i.addEventListener("readystatechange",function(e){if(2==i.readyState&&200==i.status)document.querySelector("#download-button").style.display="none",document.querySelector("#download-button").setAttribute("disabled","disabled"),document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector(".showprogress").style.display="block";else if(3==i.readyState);else if(4==i.readyState)try{t=URL.createObjectURL(i.response),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").setAttribute("href",t),document.querySelector("#save-file").setAttribute("download",namefile),document.querySelector("#save-file").style.display="block",document.querySelector(".progress").style.display="none",document.querySelector("#download-button").style.display="none",$.post(`${baseurl}`,{deletefile:"",filename:n,password:r},function(e){}),a=!1,document.querySelector("#btn-back").style.display="block",document.querySelector("#btn-back").addEventListener("click",function(e){e.preventDefault(),document.querySelector(".show-download").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="block",document.querySelector(".password").value=""})}catch(e){toastr.error(e,"Warning"),document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",window.URL.revokeObjectURL(t)}}),i.addEventListener("progress",function(e){var t=e.loaded/e.total*100,n=((new Date).getTime()-l)/1e3,r=e.loaded/n,o=r/1024;o=Math.floor(o);var i=(e.total-e.loaded)/r,s=i%60,d=i/60;s=Math.floor(s),d=Math.floor(d),a=!0,document.querySelector(".progress-bar").style.width=t+"%",document.querySelector(".progress-bar").innerHTML=parseFloat(t).toFixed(2)+"%",document.querySelector(".progress-text").innerHTML=convertSpeed(r)+" / s<br>"+(d>0?d+" min ":"")+s+" sec remaining"}),i.responseType="blob",i.open("get",n),i.send()}else toastr.error(o.response,"Warning"),document.querySelector("#download-button").removeAttribute("disabled")})}),window.onbeforeunload=function(e){if(!0===a)return e=e||window.event,e&&(e.returnValue="Sure?"),"Sure?"}}),btnUploadFile=(e=>{function t(){$("#deleteZip").prop("checked",!1),$("#sub").hasClass("hidden")?$("#sub").removeClass("hidden"):$("#sub").addClass("hidden")}function n(e){if($("#extractZip").is(":checked")){if($("#deleteZip").is(":checked"))t='{"fileName":"'+e+'","deleteXpo":"true"}';else var t='{"fileName":"'+e+'"}';document.querySelector("#submit-btn").innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i> Proses Ekstrak',document.querySelector("#submit-btn").setAttribute("disabled","disabled"),$.ajax({url:baseurl,data:{unzip:"",path:path,Xpo:t},method:"POST",success:function(e){e=JSON.parse(e),"success"==e.unzip?toastr.success("Finished"):toastr.error("Uploaded But error occured while extracting","Warning"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")},error:function(e){toastr.error("Failed"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")}})}else toastr.success("Finished"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")}Modal.createNoFooter("Upload File"),Modal.html(`\n        <div class="alert alert-warning">Target : <strong>${directory}</strong></div>\n        <form id="formUpload" onsubmit="return false" method="post" enctype="multipart/form-data">\n            <input type="hidden" class="path" value="${directory}">\n            <div class="input-group">\n                <label class="input-group-prepend">\n                    <span class="btn btn-primary">\n                        Browse<input class="formUpload-file" type="file" name="file" data-name="" data-end="" style="display: none;" multiple>\n                    </span>\n                </label>\n                <input type="text" class="form-control" readonly>\n            </div>\n            <div class="detail"></div>\n            <input type="checkbox" name="extractZip" id="extractZip" onclick="hideSub();">&nbsp;Unzip after upload.<br>\n            <span id="sub" class="hidden"><input type="checkbox" name="deleteZip" id="deleteZip">&nbsp;Delete the Zip after extraction.</span>\n            <button id="submit-btn" type="submit" class="btn btn-primary btn-block mt-2">Upload</button>\n            <div id="progress-bar" class="progress mt-2" style="display: none;">\n                <div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n            </div>\n            <div class="info_size text-center mt-1"></div>\n        </form>\n    `),path=document.querySelector(".path").value,$(function(){$(document).on("change",":file",function(){var e=$(this),t=e.get(0).files?e.get(0).files.length:1,n=e.val().replace(/\\/g,"/").replace(/.*\//,"");e.trigger("fileselect",[t,n])}),$(document).ready(function(){$(":file").on("fileselect",function(e,t,n){var a=$(this).parents(".input-group").find(":text"),r=t>1?t+" files selected":n;a.length?a.val(r):r&&alert(r)})})}),function(){function e(){var e=document.createElement("input");return e.setAttribute("type","file"),"object"==typeof e.files}function a(e){return document.getElementById(e)}var r,o;if(e()){var l=524288,s=[];r=a("formUpload");var d=document.querySelector(".formUpload-file");for(i in d)if("object"==typeof d&&"file"==d.getAttribute("type")){var c=d;break}function u(e){var t=Math.ceil(e.size/l);return t}function m(e){var t=e.files;p(t,0,t.length)}function p(e,t,n){if(t>=n)return r.reset(),s=[],!1;var a=s["data-start"];void 0===a&&(a=0),a>0&&a++;for(var o=0,i=0;i<a;i++){o=o+l;o>e[t].size&&(o=e[t].size)}document.querySelector("#submit-btn").innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i> Proses Upload',document.querySelector("#submit-btn").setAttribute("disabled","disabled"),b(e[t],a,o,s["data-end"],s["data-size"],function(){t++,p(e,t,n)})}r.reset(),r.onsubmit=function(e){e.preventDefault(),m(c,this)},c.onchange=function(e){var t=e.target?e.target:e.srcElement,n=t.files;for(var a in n)if("object"==typeof n[a]){var r=!1,i=document.querySelector(".formUpload-file");if(i.setAttribute("data-name",n[a].name),i.setAttribute("data-end",u(n[a])),"function"==typeof i.getAttribute){o=i.getAttribute("data-name"),Data_name=o;var l=u(n[a]);if(o==n[a].name&&l==i.getAttribute("data-end")){var d={"data-start":i.getAttribute("data-start"),"data-end":i.getAttribute("data-end"),"data-size":n[a].size};s=d,r=!0}}if(!1===r){d={"data-start":0,"data-end":u(n[a]),"data-size":0};s=d}}};var f=function(e,t){var n,a=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(void 0!==a){var r=new a;r.append(e),n=r.getBlob()}else n=new Blob([e]);var o=new FileReader;o.onload=function(e){var n=e.target?e.target:e.srcElement;t(n.result)},o.readAsArrayBuffer(n)};function b(e,r,i,s,d,c){if(void 0!==e){void 0===r&&(console.log("index:: "+r),r=0,console.log("index:: "+r));var u=i+l;u>e.size&&(u=e.size),v(e,i,u,function(l){var m=new FileReader,p=!0;m.onload=function(m){for(var f=m.target?m.target:m.srcElement,v="",g=new Uint8Array(f.result),y=g.byteLength,h=0;h<y;h++)v+=String.fromCharCode(g[h]);var w=md5(v);v=void 0;var $=new XMLHttpRequest;$.onreadystatechange=function(){if(4==$.readyState){console.log($.response);var l=JSON.parse($.response);if(void 0!==typeof l.response&&!0!==l.response)return toastr.error(l.response,"Warning"),!1;if(void 0!==typeof l.error&&"E_HASH"===l.error)window.setTimeout(function(){b(e,r,i,s,d,c)},1e3);else{a("progress-bar");document.querySelector("#progress-bar").style.display="flex",document.querySelector(".progress-bar").style.width=parseInt(l.percent)+"%",
document.querySelector(".progress-bar").innerHTML=parseInt(l.percent)+"%",document.querySelector(".info_size").innerHTML=`<span>File : ${l.filename}<br>Terupload ${formatFileSize(l.upload_size)} dari ${formatFileSize(l.total_size)}</span>`,window.onbeforeunload=function(e){if(!0===p)return e=e||window.event,e&&(e.returnValue="Sure?"),"Sure?"},100===l.percent&&(console.log("Finished"),p=!1,t(),n(o)),r++,r<s?window.setTimeout(function(){b(e,r,u,s,d,c)},100):c()}}},void 0!==r&&null!=r||(console.log("index:: "+r),r=0,console.log("index:: "+r)),$.open("post",baseurl+"?page=upload",!0),$.setRequestHeader("X-File-Name",e.name),$.setRequestHeader("X-Index",r),$.setRequestHeader("X-Total",s),$.setRequestHeader("X-Hash",w),$.setRequestHeader("X-Path",path),$.setRequestHeader("X-Size",d),$.send(l)},m.readAsArrayBuffer(l)})}else console.log("stop")}function v(e,t,n,a){var r;r=e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice(t,n),e.webkitSlice?f(r,function(e){a(e)}):a(r)}}else window.onload=function(){r=a("formUpload");document.querySelector(".formUpload-file");r.reset(),r.onsubmit=function(e){var t=document.createElement("img");t.setAttribute("src","loading.gif"),t.setAttribute("alt","loading"),this.appendChild(t)},c.onchange=function(e){var t="File selected";if(void 0!==typeof e){e.preventDefault();var n=e.target?e.target:e.srcElement;t=n.value||"File selected"}for(var a=document.getElementById("toupload"),r=a.getElementsByTagName("ul")[0];r.hasChildNodes();)r.removeChild(r.firstChild);var o=document.createElement("li");o.appendChild(document.createTextNode(t)),r.appendChild(o)}}}()}),$(".btn-copy").on("click",function(e){if(e.preventDefault(),files=[],files_hash=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&(files.push($(this).val()),files_hash.push($(this).data("hash")))}),0===files.length)return toastr.error("Belum ada file yang dipilih!","Warning"),!1;list_folder="",list_folder+="<strong>List folder&file : </strong>",list_folder+='<ul class="mb-0">',files.forEach(e=>{list_folder+=`<li>${e}</li>`}),list_folder+="</ul>",Modal.create("Salin Folder&File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="copy_masal">\n            <input type="hidden" name="files" value="${files_hash.join("@")}">\n            <div class="form-group">\n                <div class="alert alert-warning">\n                    ${list_folder}\n                </div>\n            </div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),btnActionSimpan()}),$(".btn-move").on("click",function(e){return e.preventDefault(),files=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&files.push($(this).val())}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(e.preventDefault(),files=[],files_hash=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&(files.push($(this).val()),files_hash.push($(this).data("hash")))}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(list_folder="",list_folder+="<strong>List folder&file : </strong>",list_folder+='<ul class="mb-0">',files.forEach(e=>{list_folder+=`<li>${e}</li>`}),list_folder+="</ul>",Modal.create("Pindah Folder&File","modal-md"),Modal.html(`\n        <form>\n            <input type="hidden" name="pindah_masal">\n            <input type="hidden" name="files" value="${files_hash.join("@")}">\n            <div class="form-group">\n                <div class="alert alert-warning">\n                    ${list_folder}\n                </div>\n            </div>\n            <div class="form-group">\n                <label>Target</label>\n                <input type="text" class="form-control" name="target_folder" value="${directory}"/>\n            </div>\n            <div class="form-group">\n                <label>Password</label>\n                <input type="password" class="form-control" name="password"/>\n            </div>\n        </form>\n    `),void btnActionSimpan()))}),btnPetunjuk=(()=>{Modal.createNoFooter("Petunjuk","modal-md"),Modal.html('<dl style="font-size: 12px;margin-bottom:0 !important">\n                    <dt>Ctrl-F / Cmd-F</dt><dd>Start searching</dd>\n                    <dt>Ctrl-G / Cmd-G</dt><dd>Find next</dd>\n                    <dt>Shift-Ctrl-G / Shift-Cmd-G</dt><dd>Find previous</dd>\n                    <dt>Shift-Ctrl-F / Cmd-Option-F</dt><dd>Replace</dd>\n                    <dt>Shift-Ctrl-R / Shift-Cmd-Option-F</dt><dd>Replace all</dd>\n                    <dt>Alt-F</dt><dd>Persistent search (dialog doesn\'t autoclose,\n                    enter to find next, Shift-Enter to find previous)</dd>\n                    <dt>Alt-G</dt><dd>Jump to line</dd>\n                    <dt>F11</dt><dd>Fullscreen</dd>\n                </dl>')}),Modal=window.Modal||{},Modal.create=function(e,t="modal-lg",n=""){var a=`<div class="modal fade fadeIn" id="modal" data-keyboard="false" data-backdrop="static">\n                    <div class="modal-dialog  ${t}">\n                        <div class="modal-content">\n                            <div class="modal-header  ${n}">\n                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <i class="fa fa-close fa-1x"></i> </button>\n                                <strong class="modal-title" id="myModalLabel"> ${e} </strong>\n                            </div>\n                            <div id="modal-data" class="modal-body"></div>\n                            <div class="modal-footer">\n                                <button type="button" data-dismiss="modal" class="btn btn-danger btn-sm">Cancel</button>\n                                <button type="button" class="btn btn-primary btn-sm btn-simpan">Submit</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>`;$("body").append(a),$("#modal").modal("show"),$("#modal-data").html('<div style="text-align:center">Sedang memuat...</div>')},Modal.createNoFooter=function(e,t="modal-lg",n=""){var a=`<div class="modal fade fadeIn" id="modal" data-keyboard="false" data-backdrop="static">\n                    <div class="modal-dialog  ${t}">\n                        <div class="modal-content">\n                            <div class="modal-header  ${n}">\n                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <i class="fa fa-close fa-1x"></i> </button>\n                                <strong class="modal-title" id="myModalLabel"> ${e} </strong>\n                            </div>\n                            <div id="modal-data" class="modal-body"></div>\n                        </div>\n                    </div>\n                </div>`;$("body").append(a),$("#modal").modal("show"),$("#modal-data").html('<div style="text-align:center">Sedang memuat...</div>')},Modal.html=(e=>{$("#modal-data").html(e)}),Modal.close=(()=>{$(".modal-body").html(""),$("#modal").modal("hide"),$(".modal-backdrop").remove()}),$("body").on("hidden.bs.modal",function(){$("#modal").remove()});