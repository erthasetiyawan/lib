function convertSpeed(t){var e=-1,a=["KB","MB","GB","TB","PB","EB","ZB","YB"];do{t/=1024,e++}while(t>1024);return Math.max(t,.1).toFixed(1)+" "+a[e]}function formatFileSize(t,e){var a=["Bytes","KB","MB","GB","TB"];if(0==t)return"n/a";var n=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return 0==n?t+" "+a[n]:(t/Math.pow(1024,n)).toFixed(1)+" "+a[n]}function rotate(t){t.setAttribute("style","transform: rotate("+rotateAngle+"deg);object-fit: cover;max-width: 100%;image-orientation: from-image;"),rotateAngle+=90}if(parsingurl=new URLSearchParams(window.location.search),page=parsingurl.get("page"),act=parsingurl.get("act"),dir=null==parsingurl.get("dir")?default_dir:parsingurl.get("dir"),type=parsingurl.get("type"),file=parsingurl.get("file"),directory=String.raw`${atob(directory)}`,$("#showpass").on("click",function(t){!0===$(this).is(":checked")?$(".pass").attr("type","text"):$(".pass").attr("type","password")}),"setting"===page&&$("#form-setting").on("submit",function(t){t.preventDefault();var e=$(this),a=$(this).find("button").text(),n=$(this).find("button");n.html(`<i class="fa fa-circle-o-notch fa-spin"></i> ${a}`).attr("disabled",!0),$.ajax({url:`${baseurl}?page=simpan`,type:"post",data:e.serializeArray(),success:function(t){window.location.reload()},error:function(){toastr.error(res.pesan,"Warning"),n.html(`${a}`).removeAttr("disabled")}})}),loadListDirectory=(()=>{$(".list_directory").html('<div class="mt-3"><div class="box"></div><div class="box"></div><div class="box"></div></div>'),$.get(`${baseurl}?page=list`,{folder:folder},function(t){$(".list_directory").html(atob(t)),window.scrollTo(0,parseInt(sessionStorage.getItem("scroll"))),null!=sessionStorage.getItem("scroll_temp")&&(window.scrollTo(0,parseInt(sessionStorage.getItem("scroll_temp"))),sessionStorage.removeItem("scroll_temp"))})}),isLogin&&(loadBreadcrumb=(()=>{$(".showBreadcrumb").html('<div><div class="box"></div></div></div>'),$.post(`${baseurl}?page=breadcrumb`,{folder:folder,dir:dir,file:file,page:page},function(t){$(".showBreadcrumb").fadeIn("slow").html(atob(t))})}),clickBreadcrumb=(t=>{var e=t.getAttribute("data-hash"),a=t.getAttribute("data-path");$(".menus"+e).html('<div class="text-center"><small><i class="fa fa-circle-o-notch fa-spin"></i> Processing</small></div>'),$.post(`${baseurl}?page=list_breadcrumb`,{path:a},function(t){$(".menus"+e).html(atob(t))})}),loadBreadcrumb()),""!==isLogin&&"edit"!==page&&"confirmation"!==page&&"add"!==page&&"setting"!==page?(window.addEventListener("scroll",t=>{if("scroll"==t.type){let t=this.scrollY;sessionStorage.setItem("scroll",t),parseInt(t)>120?$(".floating").addClass("isfloating"):$(".floating").removeClass("isfloating")}}),loadListDirectory()):window.scrollTo(0,0),"edit"===page){$(".loading").show(),$("#codearea").hide(),$(".editor").hide(),$.post(`${baseurl}`,{read_file:"",file:file},function(t){$(".loading").hide(),$(".editor").fadeIn("slow").show(),$("#codearea").fadeIn("slow").show(),document.querySelector("#codearea").value=window.atob(window.atob(window.atob(t))),codemirrorEditor=CodeMirror.fromTextArea(document.getElementById("codearea"),{lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0,keyMap:"sublime",theme:"material-ocean",matchBrackets:!0,mode:{name:"javascript",startOpen:!0},extraKeys:{"Alt-F":"findPersistent",F11:function(t){t.setOption("fullScreen",!t.getOption("fullScreen"))},Esc:function(t){t.getOption("fullScreen")&&t.setOption("fullScreen",!1)}},indentUnit:4,indentWithTabs:!0,lineWrapping:!0,tabSize:4}),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(t){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)});var ask=!1;fungsi_simpan=(()=>{var t=$(".btn-simpan-file"),e=btoa(codemirrorEditor.getValue()),a=$(".path_file").val(),n=$(".path").val(),r=$("#nama_file").val(),i=$(".password").val(),o=new XMLHttpRequest;if(""===i.trim())return toastr.error("Password can't empty!","Warning"),!1;t.html('<i class="fa fa-circle-o-notch fa-spin"></i>').attr("disabled",!0),o.onload=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.response);1==e.status?(ask=!1,toastr.success(e.response,"Information"),$.post(`${baseurl}?page=detail_file`,{file:a},function(t){$(".last_updated").html(t)})):toastr.error(e.response,"Warning"),t.html('<i class="fa fa-save"></i>').removeAttr("disabled")}else alert("Target server reached, but it returned an error")},o.onerror=function(){},o.open("POST",baseurl,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.send("savefile=&folder="+n+"&nama_file="+r+"&path="+a+"&password="+i+"&content="+encodeURIComponent(e))}),$(window).bind("keydown",function(t){if(t.ctrlKey||t.metaKey)switch(String.fromCharCode(t.which).toLowerCase()){case"s":t.preventDefault(),fungsi_simpan()}"textarea"===t.target.localName&&(ask=!0)}),$(".btn-simpan-file").on("click",function(t){t.preventDefault(),fungsi_simpan()}),$(".btn-fullscreen").on("click",function(t){t.preventDefault(),$(".card.editor").addClass("fullscreen");var e=window.innerHeight;$(".CodeMirror").css({height:`${e-82}px`}),window.addEventListener("resize",function(t){e=window.innerHeight,$(".CodeMirror").css({height:`${e-82}px`})},!0),$(".btn-fullscreen").hide(),$(".btn-minimize").show()}),$(".btn-minimize").on("click",function(t){t.preventDefault(),$(".card.editor").removeClass("fullscreen"),$(".btn-fullscreen").show(),$(".btn-minimize").hide(),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(t){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)}),window.onbeforeunload=function(t){if(!0===ask)return t=t||window.event,t&&(t.returnValue="Sure?"),"Sure?"}}if("add"===page&&"file"===type){var codemirrorEditor;codemirrorEditor=CodeMirror.fromTextArea(document.getElementById("codearea"),{lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0,keyMap:"sublime",theme:"material-ocean",matchBrackets:!0,mode:{name:"javascript",startOpen:!0},indentUnit:4,indentWithTabs:!0,lineWrapping:!0,tabSize:4,extraKeys:{"Alt-F":"findPersistent",F11:function(t){t.setOption("fullScreen",!t.getOption("fullScreen"))},Esc:function(t){t.getOption("fullScreen")&&t.setOption("fullScreen",!1)}}}),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(t){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0);ask=!1;$(window).bind("keydown",function(t){ask=!0}),$(".btn-simpan-file").on("click",function(t){t.preventDefault();var e=new FormData(document.getElementById("form-add-file")),a=codemirrorEditor.getValue();e.append("password",document.getElementById("password").value.trim()),e.append("content",a),e.append("nama_file",document.getElementById("nama_file").value.trim()),$(".btn-simpan-file").html('<i class="fa fa-circle-o-notch fa-spin"></i>').attr("disabled",!0),$.ajax({url:`${baseurl}`,type:"post",data:e,processData:!1,contentType:!1,dataType:"json",success:function(t){!0===t.status?(ask=!1,toastr.success(t.pesan,"Success"),setTimeout(()=>{window.location.href=t.redirect},1e3)):($(".btn-simpan-file").html('<i class="fa fa-save"></i>'),toastr.error(t.pesan,"Warning"))}})}),$(".btn-fullscreen").on("click",function(t){t.preventDefault(),$(".card.editor").addClass("fullscreen");var e=window.innerHeight;$(".CodeMirror").css({height:`${e-82}px`}),window.addEventListener("resize",function(t){e=window.innerHeight,$(".CodeMirror").css({height:`${e-82}px`})},!0),$(".btn-fullscreen").hide(),$(".btn-minimize").show()}),$(".btn-minimize").on("click",function(t){t.preventDefault(),$(".card.editor").removeClass("fullscreen"),$(".btn-fullscreen").show(),$(".btn-minimize").hide(),$(".CodeMirror").css({height:`${window.innerHeight-295}px`}),window.addEventListener("resize",function(t){tinggi=window.innerHeight,$(".CodeMirror").css({height:`${tinggi-295}px`})},!0)}),window.onbeforeunload=function(t){if(!0===ask)return t=t||window.event,t&&(t.returnValue="Sure?"),"Sure?"}}$("#login").on("submit",function(t){t.preventDefault();var e=$(this),a=$(this).find("button").text(),n=$(this).find("button");n.html(`<i class="fa fa-circle-o-notch fa-spin"></i> ${a}`).attr("disabled",!0),$.ajax({url:`${baseurl}`,type:"post",data:e.serializeArray(),dataType:"json",success:function(t){!0===t.status?(toastr.success(t.pesan,"Success"),setTimeout(()=>{window.location.reload()},1e3)):(toastr.error(t.pesan,"Warning"),n.html(`${a}`).removeAttr("disabled"))},error:function(){toastr.error("Something wrong!","Warning"),n.html(`${a}`).removeAttr("disabled")}})}),btnActionSimpan=(()=>{$("button.btn-simpan").on("click",function(t){t.preventDefault();var e=$("form"),a=$(this).text(),n=$(this);$(".modal-footer").find("button").attr("disabled",!0),n.html(`<i class="fa fa-circle-o-notch fa-spin"></i> ${a}`),sessionStorage.setItem("scroll_temp",sessionStorage.getItem("scroll")),$.ajax({url:`${baseurl}`,type:"post",data:e.serializeArray(),dataType:"json",success:function(t){!0===t.status?(toastr.success(t.pesan,"Success"),setTimeout(()=>{Modal.close(),loadListDirectory()},1e3)):(toastr.error(t.pesan,"Warning"),n.html(a),$(".modal-footer").find("button").removeAttr("disabled",!0))},error:function(){toastr.error("Something wrong!","Warning"),n.html(a),$(".modal-footer").find("button").removeAttr("disabled",!0)}})})}),btnTambahFolder=(t=>{hash=t.getAttribute("data-hash"),dir=t.getAttribute("data-dir"),Modal.create("Tambah Folder"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="add_folder">\n\t\t\t\t\t<input type="hidden" name="dir" value="${hash}">\n\t\t\t\t\t<div class="alert alert-warning">Target : <strong>${dir}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Folder</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="nama_folder"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnUbahFolder=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),Modal.create("Ubah Folder"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="edit_folder">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Folder</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="nama_folder" value="${name}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnHapusFolder=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),Modal.create("Hapus Folder"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="delete_folder">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="alert alert-warning">Anda yakin ingin menghapus folder <strong>${name}</strong> secara permanen?</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnSalinFolder=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),Modal.create("Salin Folder"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="salin_folder">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="alert alert-warning">Folder : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnPindahFolder=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),Modal.create("Pindah Folder"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="pindah_folder">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="alert alert-warning">Folder : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnBackupFolder=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),Modal.create("Backup"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="backup_folder">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="alert alert-warning">Folder : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Exclude</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="exclude" value="${exclude}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${path_backup}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnUbahFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.create("Ubah File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="edit">\n\t\t\t\t\t<input type="hidden" name="path_file" value="${file}">\n\t\t\t\t\t<input type="hidden" name="folder" value="${dir}">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>File</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="nama_file" value="${name}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnHapusFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.create("Hapus File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="delete">\n\t\t\t\t\t<input type="hidden" name="path_file" value="${file}">\n\t\t\t\t\t<div class="alert alert-warning">Anda yakin ingin menghapus file <strong>${name}</strong> secara permanen?</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnSalinFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.create("Salin File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="copy">\n\t\t\t\t\t<input type="hidden" name="path_file" value="${file}">\n\t\t\t\t\t<div class="alert alert-warning">File : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnPindahFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.create("Pindah File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="move">\n\t\t\t\t\t<input type="hidden" name="path_file" value="${file}">\n\t\t\t\t\t<div class="alert alert-warning">File : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnEkstrakFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.create("Ekstrak File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="ekstrak">\n\t\t\t\t\t<input type="hidden" name="files" value="${file}">\n\t\t\t\t\t<div class="alert alert-warning">File : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnDownloadFile=(t=>{var e,a;name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.createNoFooter("Download File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="download">\n\t\t\t\t\t<input type="hidden" id="file" value="${file}">\n\t\t\t\t\t<div class="alert alert-warning">File : <strong>${name}</strong></div>\n\t\t\t\t\t<div class="form-group mb-1 showpassword">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control password"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<label for="cekzip" class="mb-1">\n\t\t\t\t\t\t<input id="cekzip" type="checkbox" value="0">\n\t\t\t\t\t\tArchive (Zip)\n\t\t\t\t\t</label>\n\t\t\t\t\t<div class="show-download" style="display: none;">\n\t\t\t\t\t\t<a href="" class="btn btn-primary btn-block">Download Manual <small>(Opsi jika file terlalu besar)</small></a>\n\t\t\t\t\t\t<div class="text-center mt-2"><label>atau</label></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="submit" id="download-button" class="btn btn-primary btn-block">Generate Download</button>\n\t\t\t\t\t<a id="save-file" class="btn btn-primary mt-2" style="display: none;">Save File</a>\n\t\t\t\t\t<button id="btn-back" style="display: none;" class="btn btn-danger btn-block mt-2">Kembali</button>\n\t\t\t\t\t<div class="showprogress" style="display: none;">\n\t\t\t\t\t\t<div class="progress mt-2">\n\t\t\t\t\t\t\t<div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="progress-text text-center"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`);var n=!1;document.querySelector("#cekzip").addEventListener("click",function(t){var e=this;0==e.value?e.value=1:e.value=0}),document.querySelector("#download-button").addEventListener("click",function(t){t.preventDefault();var r=$(".password").val(),i=document.getElementById("cekzip").value,o=document.getElementById("file").value;document.querySelector("#download-button").setAttribute("disabled","disabled"),$.post(`${baseurl}`,{download:"",password:r,iszip:i,file:o},function(t){let i=JSON.parse(t);if(!0===i.status){var o=new XMLHttpRequest,l=(new Date).getTime();a=i.filename,namefile=i.name,$(".show-download").fadeIn("slow").show(),$(".show-download a").attr("href",a),o.addEventListener("readystatechange",function(t){if(2==o.readyState&&200==o.status)document.querySelector("#download-button").style.display="none",document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector(".showprogress").style.display="block",document.querySelector("#download-button").setAttribute("disabled","disabled");else if(3==o.readyState);else if(4==o.readyState)try{e=URL.createObjectURL(o.response),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").setAttribute("href",e),document.querySelector("#save-file").setAttribute("download",namefile),document.querySelector("#save-file").style.display="block",document.querySelector(".progress").style.display="none",$.post(`${baseurl}`,{deletefile:"",filename:a,password:r},function(t){}),n=!1,document.querySelector("#btn-back").style.display="block",document.querySelector("#btn-back").addEventListener("click",function(t){t.preventDefault(),window.URL.revokeObjectURL(e),document.querySelector(".show-download").style.display="none",document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",document.querySelector("#save-file").style.display="none",document.querySelector(".showpassword").style.display="block",document.querySelector(".password").value=""})}catch(t){toastr.error(t,"Warning"),document.querySelector("#btn-back").style.display="none",document.querySelector("#download-button").style.display="block",document.querySelector("#download-button").removeAttribute("disabled"),document.querySelector(".showprogress").style.display="none",window.URL.revokeObjectURL(e)}}),o.addEventListener("progress",function(t){var e=t.loaded/t.total*100,a=((new Date).getTime()-l)/1e3,r=t.loaded/a,i=r/1024;i=Math.floor(i);var o=(t.total-t.loaded)/r,s=o%60,d=o/60;s=Math.floor(s),d=Math.floor(d),n=!0,document.title=`${parseInt(e)}% ${namefile} - ${app_name}`,document.querySelector(".progress-bar").style.width=e+"%",document.querySelector(".progress-bar").innerHTML=parseFloat(e).toFixed(2)+"%",document.querySelector(".progress-text").innerHTML=convertSpeed(r)+" / s<br>"+(d>0?d+" min ":"")+s+" sec remaining"}),o.responseType="blob",o.open("get",a),o.send()}else document.title=app_name,toastr.error(i.response,"Warning"),document.querySelector("#download-button").removeAttribute("disabled")})}),window.onbeforeunload=function(t){if(!0===n)return t=t||window.event,t&&(t.returnValue="Sure?"),"Sure?"}}),btnUploadFile=(t=>{function e(){$("#deleteZip").prop("checked",!1),$("#sub").hasClass("hidden")?$("#sub").removeClass("hidden"):$("#sub").addClass("hidden")}function a(t){if($("#extractZip").is(":checked")){if($("#deleteZip").is(":checked"))e='{"fileName":"'+t+'","deleteXpo":"true"}';else var e='{"fileName":"'+t+'"}';document.querySelector("#submit-btn").innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i> Proses Ekstrak',document.querySelector("#submit-btn").setAttribute("disabled","disabled"),$.ajax({url:baseurl,data:{unzip:"",path:path,Xpo:e},method:"POST",success:function(t){t=JSON.parse(t),"success"==t.unzip?toastr.success("Finished"):toastr.error("Uploaded But error occured while extracting","Warning"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")},error:function(t){toastr.error("Failed"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")}})}else toastr.success("Finished"),document.querySelector("#submit-btn").innerHTML="Upload",document.querySelector("#submit-btn").removeAttribute("disabled")}Modal.createNoFooter("Upload File"),Modal.html(`\n\t\t\t\t<div class="alert alert-warning">Target : <strong>${directory}</strong></div>\n\t\t\t\t<form id="formUpload" onsubmit="return false" method="post" enctype="multipart/form-data">\n\t\t\t\t\t<input type="hidden" class="path" value="${directory}">\n\t\t\t\t\t<div class="input-group mb-2">\n\t\t\t\t\t\t<label class="input-group-prepend">\n\t\t\t\t\t\t\t<span class="btn btn-primary" style="padding:5px 12px !important;">\n\t\t\t\t\t\t\t\tBrowse<input class="formUpload-file" type="file" name="file" data-name="" data-end="" style="display: none;" multiple>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<input type="text" class="form-control" style="border-top-left-radius:0 !important;border-bottom-left-radius:0 !important;" readonly>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="detail"></div>\n\t\t\t\t\t<input type="checkbox" name="extractZip" id="extractZip" onclick="hideSub();">&nbsp;Unzip after upload.<br>\n\t\t\t\t\t<span id="sub" class="hidden"><input type="checkbox" name="deleteZip" id="deleteZip">&nbsp;Delete the Zip after extraction.</span>\n\t\t\t\t\t<button id="submit-btn" type="submit" class="btn btn-primary btn-block mt-2">Upload</button>\n\t\t\t\t\t<div id="progress-bar" class="progress mt-2" style="display: none;">\n\t\t\t\t\t\t<div class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="info_size text-center mt-1"></div>\n\t\t\t\t</form>\n\t\t\t`),path=document.querySelector(".path").value,$(function(){$(document).on("change",":file",function(){var t=$(this),e=t.get(0).files?t.get(0).files.length:1,a=t.val().replace(/\\/g,"/").replace(/.*\//,"");t.trigger("fileselect",[e,a])}),$(document).ready(function(){$(":file").on("fileselect",function(t,e,a){var n=$(this).parents(".input-group").find(":text"),r=e>1?e+" files selected":a;n.length?n.val(r):r&&alert(r)})})}),function(){function t(){var t=document.createElement("input");return t.setAttribute("type","file"),"object"==typeof t.files}function n(t){return document.getElementById(t)}var r,o;if(t()){var l=524288,s=[];r=n("formUpload");var d=document.querySelector(".formUpload-file");for(i in d)if("object"==typeof d&&"file"==d.getAttribute("type")){var c=d;break}function u(t){var e=Math.ceil(t.size/l);return e}function m(t){var e=t.files;p(e,0,e.length)}function p(t,e,a){if(e>=a)return r.reset(),s=[],!1;var n=s["data-start"];void 0===n&&(n=0,console.log("index:: "+n)),n>0&&n++;for(var i=0,o=0;o<n;o++){i=i+l;i>t[e].size&&(i=t[e].size)}document.querySelector("#submit-btn").innerHTML='<i class="fa fa-circle-o-notch fa-spin"></i> Proses Upload',document.querySelector("#submit-btn").setAttribute("disabled","disabled"),b(t[e],n,i,s["data-end"],s["data-size"],function(){e++,p(t,e,a)})}r.reset(),r.onsubmit=function(t){t.preventDefault(),m(c,this)},c.onchange=function(t){var e=t.target?t.target:t.srcElement,a=e.files;for(var n in a)if("object"==typeof a[n]){var r=!1,i=document.querySelector(".formUpload-file");if(i.setAttribute("data-name",a[n].name),i.setAttribute("data-end",u(a[n])),"function"==typeof i.getAttribute){o=i.getAttribute("data-name"),Data_name=o;var l=u(a[n]);if(o==a[n].name&&l==i.getAttribute("data-end")){var d={"data-start":i.getAttribute("data-start"),"data-end":i.getAttribute("data-end"),"data-size":a[n].size};s=d,r=!0}}if(!1===r){d={"data-start":0,"data-end":u(a[n]),"data-size":0};s=d}}};var f=function(t,e){var a,n=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(void 0!==n){var r=new n;r.append(t),a=r.getBlob()}else a=new Blob([t]);var i=new FileReader;i.onload=function(t){var a=t.target?t.target:t.srcElement;e(a.result)},i.readAsArrayBuffer(a)};function b(t,r,i,s,d,c){if(void 0!==t){void 0===r&&(r=0);var u=i+l;u>t.size&&(u=t.size),g(t,i,u,function(l){var m=new FileReader,p=!0;m.onload=function(m){for(var f=m.target?m.target:m.srcElement,g="",h=new Uint8Array(f.result),v=h.byteLength,y=0;y<v;y++)g+=String.fromCharCode(h[y]);var w=md5(g);g=void 0;var $=new XMLHttpRequest;$.onreadystatechange=function(){if(4==$.readyState){var l=JSON.parse($.response);if(void 0!==typeof l.response&&!0!==l.response)return toastr.error(l.response,"Warning"),!1;if(void 0!==typeof l.error&&"E_HASH"===l.error)window.setTimeout(function(){b(t,r,i,s,d,c)},1e3);else{n("progress-bar");document.querySelector("#progress-bar").style.display="flex",document.querySelector(".progress-bar").style.width=parseInt(l.percent)+"%",document.querySelector(".progress-bar").innerHTML=parseInt(l.percent)+"%",document.querySelector(".info_size").innerHTML=`<span>File : ${l.filename}<br>Terupload ${formatFileSize(l.upload_size)} dari ${formatFileSize(l.total_size)}</span>`,document.title=`${parseInt(l.percent)}% uploaded - ${app_name}`,document.querySelector("button.close").style.display="none",window.onbeforeunload=function(t){if(!0===p)return t=t||window.event,t&&(t.returnValue="Sure?"),"Sure?"},100===l.percent&&(loadListDirectory(),p=!1,e(),a(o),document.querySelector("button.close").style.display="block"),r++,r<s?window.setTimeout(function(){b(t,r,u,s,d,c)},100):c()}}},void 0!==r&&null!=r||(r=0),$.open("post",baseurl+"?page=upload",!0),$.setRequestHeader("X-File-Name",t.name),$.setRequestHeader("X-Index",r),$.setRequestHeader("X-Total",s),$.setRequestHeader("X-Hash",w),$.setRequestHeader("X-Path",path),$.setRequestHeader("X-Size",d),$.send(l)},m.readAsArrayBuffer(l)})}}function g(t,e,a,n){var r;r=t.webkitSlice?t.webkitSlice(e,a):t.mozSlice?t.mozSlice(e,a):t.slice(e,a),t.webkitSlice?f(r,function(t){n(t)}):n(r)}}else{r=n("formUpload");d=document.querySelector(".formUpload-file");r.reset(),r.onsubmit=function(t){var e=document.createElement("img");e.setAttribute("src","loading.gif"),e.setAttribute("alt","loading"),this.appendChild(e)},c.onchange=function(t){var e="File selected";if(void 0!==typeof t){t.preventDefault();var a=t.target?t.target:t.srcElement;console.log(a),e=a.value||"File selected"}for(var n=document.getElementById("toupload"),r=n.getElementsByTagName("ul")[0];r.hasChildNodes();)r.removeChild(r.firstChild);var i=document.createElement("li");i.appendChild(document.createTextNode(e)),r.appendChild(i)}}}()});let rotateAngle=90;var Modal;btnPreviewFile=(t=>{name=t.getAttribute("data-name"),dir=t.getAttribute("data-dir"),file=t.getAttribute("data-file"),Modal.createNoFooter("Preview File"),$.post(`${baseurl}?page=preview`,{file:file},function(t){var e=JSON.parse(t),a="";a="svg"===e.type?`<img id="rotater" onclick="rotate(this)" src="data:${e.mime}+xml;base64,${e.src}" class="img-fluid">`:"pdf"===e.type?`<embed style="width:100%;" src="data:${e.mime};base64,${e.src}" class="img-fluid"></embed>`:`<img id="rotater" onclick="rotate(this)" src="data:${e.mime};base64,${e.src}" class="img-fluid">`,Modal.html(`\n\t\t\t\t\t\t<div class="alert alert-warning">Nama File : <strong>${name}</strong><br>Path File : <strong>${e.file}</strong></div>\n\t\t\t\t\t\t<div class="text-center">${a}</div>\n\t\t\t\t`),$("embed").css({height:`${window.innerHeight-250}px`})})}),btnPetunjuk=(()=>{Modal.createNoFooter("Petunjuk","modal-md"),Modal.html('<dl style="font-size: 12px;margin-bottom:0 !important">\n\t\t\t\t\t\t\t<dt>Ctrl-F / Cmd-F</dt><dd>Start searching</dd>\n\t\t\t\t\t\t\t<dt>Ctrl-G / Cmd-G</dt><dd>Find next</dd>\n\t\t\t\t\t\t\t<dt>Shift-Ctrl-G / Shift-Cmd-G</dt><dd>Find previous</dd>\n\t\t\t\t\t\t\t<dt>Shift-Ctrl-F / Cmd-Option-F</dt><dd>Replace</dd>\n\t\t\t\t\t\t\t<dt>Shift-Ctrl-R / Shift-Cmd-Option-F</dt><dd>Replace all</dd>\n\t\t\t\t\t\t\t<dt>Alt-F</dt><dd>Persistent search (dialog doesn\'t autoclose,\n\t\t\t\t\t\t\tenter to find next, Shift-Enter to find previous)</dd>\n\t\t\t\t\t\t\t<dt>Alt-G</dt><dd>Jump to line</dd>\n\t\t\t\t\t\t\t<dt>F11</dt><dd>Fullscreen</dd>\n\t\t\t\t\t\t</dl>')}),btnCekUpdate=(()=>{Modal.createNoFooter("Cek Pembaharuan"),$.ajax({url:`${baseurl}?page=cek_update`,type:"get",dataType:"json",success:function(t){var e="";e=1==t.code?`<div class="text-center">\n\t\t\t\t\t\t\t\t\t${t.message}\n\t\t\t\t\t\t\t\t\t<br><button type="button" onclick="btnUpdateNow(this)" class="btn btn-success mt-2">Perbaharui Sekarang</button>\n\t\t\t\t\t\t\t\t</div>`:`<div class="text-center">${t.message}</div>`,Modal.html(`${e}`)}})}),btnUpdateNow=(t=>{
t.setAttribute("disabled","disabled");var e=t.textContent;t.innerHTML=`<i class="fa fa-circle-o-notch fa-spin"></i> ${e}`,$.ajax({url:`${baseurl}?page=source_update`,type:"get",dataType:"json",success:function(a){"sukses"===a.status?(toastr.success(a.response),setTimeout(()=>{window.location.reload()},1e3)):(t.innerHTML=e,t.removeAttribute("disabled"),toastr.error(a.response))},error:function(){t.innerHTML=e,t.removeAttribute("disabled"),toastr.error("Something wrong!")}})}),btnCopy=(t=>{if(files=[],files_hash=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&(files.push($(this).val()),files_hash.push($(this).data("hash")))}),0===files.length)return toastr.error("Belum ada file yang dipilih!","Warning"),!1;list_folder="",list_folder+="<strong>List folder & file : </strong>",list_folder+='<ul class="mb-0">',files.forEach(t=>{list_folder+=`<li>${t}</li>`}),list_folder+="</ul>",Modal.create("Salin Folder & File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="copy_masal">\n\t\t\t\t\t<input type="hidden" name="files" value="${files_hash.join("@")}">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<div class="alert alert-warning">\n\t\t\t\t\t\t\t${list_folder}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),btnActionSimpan()}),btnMove=(t=>(files=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&files.push($(this).val())}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(files=[],files_hash=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&(files.push($(this).val()),files_hash.push($(this).data("hash")))}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(list_folder="",list_folder+="<strong>List folder & file : </strong>",list_folder+='<ul class="mb-0">',files.forEach(t=>{list_folder+=`<li>${t}</li>`}),list_folder+="</ul>",Modal.create("Pindah Folder & File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="pindah_masal">\n\t\t\t\t\t<input type="hidden" name="files" value="${files_hash.join("@")}">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<div class="alert alert-warning">\n\t\t\t\t\t\t\t${list_folder}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${directory}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),void btnActionSimpan())))),btnBackup=(t=>(files=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&files.push($(this).val())}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(files=[],files_hash=[],$(".cekfiles").each(function(){!0===$(this).is(":checked")&&(files.push($(this).val()),files_hash.push($(this).data("hash")))}),0===files.length?(toastr.error("Belum ada file yang dipilih!","Warning"),!1):(list_folder="",list_folder+="<strong>List folder & file : </strong>",list_folder+='<ul class="mb-0">',files.forEach(t=>{list_folder+=`<li>${t}</li>`}),list_folder+="</ul>",Modal.create("Backup Folder & File"),Modal.html(`\n\t\t\t\t<form>\n\t\t\t\t\t<input type="hidden" name="backup">\n\t\t\t\t\t<input type="hidden" name="files" value="${files_hash.join("@")}">\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<div class="alert alert-warning">\n\t\t\t\t\t\t\t${list_folder}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Exclude</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="exclude" value="${exclude}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Target</label>\n\t\t\t\t\t\t<input type="text" class="form-control" name="target_folder" value="${path_backup}"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="form-group">\n\t\t\t\t\t\t<label>Password</label>\n\t\t\t\t\t\t<input type="password" class="form-control" name="password"/>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t`),void btnActionSimpan())))),btnRecycle=(t=>{t.setAttribute("disabled","disabled"),$.ajax({url:`${baseurl}?page=trash`,success:function(){window.location.reload()},error:function(){t.removeAttribute("disabled"),toastr.error("Something wrong!")}})}),Modal=window.Modal||{},Modal.create=function(t,e="modal-lg",a=""){var n=`<div class="modal fade fadeIn" id="modal" data-keyboard="false" data-backdrop="static">\n\t\t\t\t\t\t\t<div class="modal-dialog  ${e}">\n\t\t\t\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t\t\t\t<div class="modal-header  ${a}">\n\t\t\t\t\t\t\t\t\t\t<!--<button type="button" class="close" data-dismiss="modal" aria-label="Close"> <i class="fa fa-close fa-1x"></i> </button>-->\n\t\t\t\t\t\t\t\t\t\t<strong class="modal-title" id="myModalLabel"> ${t} </strong>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="modal-data" class="modal-body"></div>\n\t\t\t\t\t\t\t\t\t<div class="modal-footer">\n\t\t\t\t\t\t\t\t\t\t<button type="button" data-dismiss="modal" class="btn btn-danger btn-sm">Cancel</button>\n\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-primary btn-sm btn-simpan">Submit</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`;$("body").append(n),$("#modal").modal("show"),$("#modal-data").html('<div style="text-align:center">Sedang memuat...</div>')},Modal.createNoFooter=function(t,e="modal-lg",a=""){var n=`<div class="modal fade fadeIn" id="modal" data-keyboard="false" data-backdrop="static">\n\t\t\t\t\t\t\t<div class="modal-dialog  ${e}">\n\t\t\t\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t\t\t\t<div class="modal-header  ${a}">\n\t\t\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-label="Close"> <i class="fa fa-close fa-1x"></i> </button>\n\t\t\t\t\t\t\t\t\t\t<strong class="modal-title" id="myModalLabel"> ${t} </strong>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="modal-data" class="modal-body"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`;$("body").append(n),$("#modal").modal("show"),$("#modal-data").html('<div style="text-align:center">Sedang memuat...</div>')},Modal.html=(t=>{$("#modal-data").html(t)}),Modal.close=(()=>{$(".modal-body").html(""),$("#modal").modal("hide"),$(".modal-backdrop").remove()}),$("body").on("hidden.bs.modal",function(){$("#modal").remove(),""!==file_name?document.title=file_name+""+app_name:document.timeline=app_name});